# Rules
- Key Info
    - after identify malware TTPs, possible to create rules

- Tools: `Yara` & `Sigma`

# Yara >> Yet Another Recursive Algorithm
- Functions:
    - open-source pattern matching tool
    - rule-based malware detection >> specific patterns >> files >> processes >> memory

    - possible to create custom rules & automate rule creation

- **YarGen:**
    - Yara-rule generator Tool
    - pyhton-based tool
        - `sudo python3 yarGen.py -m malware.exe`
        - analyse the .exe file
        - applies smart filters
        - creates `yargen_rules.yar` file

- **Detecting Malware Using Yara Rules:**
    - `sudo yara yargen_rules.yar /path_to_malware/`

# Sigma
- Functions:
    -  standardized rule format
    -  used by SIEM
    -  identify specific patterns or behaviors
    -  Works ideal in combination with `Sysmon` logs

- Rule Example:
    -```title: Suspicious File Drop in Users Temp Location
    status: experimental
    description: Detects suspicious activity where a file is dropped in the temp location

    logsource:
        category: process_creation
    detection:
        selection:
            TargetFilename:
                - '*\\AppData\\Local\\Temp\\svchost.exe'
        condition: selection
        level: high

     falsepositives:
        - Legitimate exe file drops in temp location```



